<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Flashcards com Quiz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; background: #f0f4f8; margin: 0; padding: 20px; }
    #app { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px #ccc; }
    h1 { text-align: center; color: #2c3e50; }
    .hidden { display: none; }
    button { margin: 5px; padding: 10px 15px; border: none; border-radius: 5px; background: #3498db; color: white; cursor: pointer; }
    input, textarea { width: 100%; margin: 5px 0; padding: 10px; border-radius: 5px; border: 1px solid #ccc; }
    .card { background: #ecf0f1; padding: 20px; border-radius: 10px; margin-bottom: 15px; text-align: center; }
  </style>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js"></script>
</head>
<body>
  <div id="app">
    <h1>Flashcards com Quiz</h1>
    
    <!-- Área de login -->
    <div id="login-area">
      <button onclick="login()">Entrar com Google</button>
    </div>

    <!-- Área principal (só aparece após login) -->
    <div id="main-area" class="hidden">
      <p>Bem-vindo, <span id="user-name"></span>!</p>
      <button onclick="logout()">Sair</button>

      <h3>Novo Flashcard</h3>
      <input type="text" id="subject" placeholder="Matéria">
      <textarea id="question" placeholder="Pergunta"></textarea>
      <textarea id="answer" placeholder="Resposta"></textarea>
      <button onclick="addFlashcard()">Salvar Flashcard</button>

      <h3>Seus Flashcards</h3>
      <div id="flashcard-list"></div>

      <button onclick="startQuiz()">Iniciar Quiz</button>
      <div id="quiz-area" class="hidden">
        <div class="card">
          <p id="quiz-question"></p>
          <button onclick="showAnswer()">Mostrar Resposta</button>
          <p id="quiz-answer" class="hidden"></p>
          <button onclick="nextQuiz()">Próxima</button>
        </div>
      </div>
    </div>
  </div>

  <script type="module">
    // Configuração Firebase (substitua pelos dados do seu projeto)
      const firebaseConfig = {
      apiKey: "AIzaSyCj8i37JYNigvbhXfqP4HVzjAEOzcXf_i0",
      authDomain: "sdel-b3f65.firebaseapp.com",
      projectId: "sdel-b3f65",
      storageBucket: "sdel-b3f65.firebasestorage.app",
      messagingSenderId: "297725999985",
      appId: "1:297725999985:web:d41da68311c190ef8a54d0",
      measurementId: "G-PT92VECJ2H"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    let currentUser = null;
    let flashcards = [];
    let quizIndex = 0;

    onAuthStateChanged(auth, async (user) => {
      if (user) {
        currentUser = user;
        document.getElementById("user-name").innerText = user.displayName || user.email;
        document.getElementById("login-area").classList.add("hidden");
        document.getElementById("main-area").classList.remove("hidden");
        await loadFlashcards();
      }
    });

    async function login() {
      const provider = new GoogleAuthProvider();
      try {
        await signInWithPopup(auth, provider);
      } catch (error) {
        alert("Erro no login: " + error.message);
      }
    }

    function logout() {
      signOut(auth);
      location.reload();
    }

    async function addFlashcard() {
      const subject = document.getElementById("subject").value.trim();
      const question = document.getElementById("question").value.trim();
      const answer = document.getElementById("answer").value.trim();
      if (!subject || !question || !answer) {
        alert("Preencha todos os campos!");
        return;
      }

      await addDoc(collection(db, "flashcards"), {
        uid: currentUser.uid,
        subject,
        question,
        answer
      });

      document.getElementById("subject").value = "";
      document.getElementById("question").value = "";
      document.getElementById("answer").value = "";
      await loadFlashcards();
    }

    async function loadFlashcards() {
      const q = query(collection(db, "flashcards"), where("uid", "==", currentUser.uid));
      const snapshot = await getDocs(q);
      flashcards = snapshot.docs.map(doc => doc.data());
      renderFlashcards();
    }

    function renderFlashcards() {
      const list = document.getElementById("flashcard-list");
      list.innerHTML = "";
      flashcards.forEach((card, i) => {
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `<strong>${card.subject}</strong><br><em>${card.question}</em><br>${card.answer}`;
        list.appendChild(div);
      });
    }

    function startQuiz() {
      if (flashcards.length === 0) return alert("Nenhum flashcard encontrado.");
      document.getElementById("quiz-area").classList.remove("hidden");
      quizIndex = 0;
      showQuiz();
    }

    function showQuiz() {
      const card = flashcards[quizIndex];
      document.getElementById("quiz-question").innerText = card.question;
      document.getElementById("quiz-answer").innerText = card.answer;
      document.getElementById("quiz-answer").classList.add("hidden");
    }

    function showAnswer() {
      document.getElementById("quiz-answer").classList.remove("hidden");
    }

    function nextQuiz() {
      quizIndex = (quizIndex + 1) % flashcards.length;
      showQuiz();
    }
  </script>
</body>
</html>
